<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-K.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-K.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-K.png">
  <link rel="mask-icon" href="/images/logo-K.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.15.1","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="本笔记源自黑马程序员的视频课程——《瑞吉外卖》，总结了课程笔记、相关知识点以及可能遇到的问题解决方案，并且增加了课程中未实现的功能，供读者参考。笔记全面且条理清晰，希望帮助读者学习和理解这个外卖项目。本项目全部笔记见：外卖项目笔记合集 1. 菜品管理业务开发1.1 文件上传下载1.1.1 文件上传介绍文件上传，也称为upload，是指将本地图片、视频、音频等文件上传到服务器上，可以供其他用户浏览或">
<meta property="og:type" content="article">
<meta property="og:title" content="瑞吉外卖04-菜品管理">
<meta property="og:url" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/index.html">
<meta property="og:site_name" content="Kathy&#39;s Blog">
<meta property="og:description" content="本笔记源自黑马程序员的视频课程——《瑞吉外卖》，总结了课程笔记、相关知识点以及可能遇到的问题解决方案，并且增加了课程中未实现的功能，供读者参考。笔记全面且条理清晰，希望帮助读者学习和理解这个外卖项目。本项目全部笔记见：外卖项目笔记合集 1. 菜品管理业务开发1.1 文件上传下载1.1.1 文件上传介绍文件上传，也称为upload，是指将本地图片、视频、音频等文件上传到服务器上，可以供其他用户浏览或">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/1.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/2.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/3.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/4.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/5.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/6.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/7.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/8.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/9.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/10.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/11.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/12.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/13.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/14.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/15.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/16.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/17.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/18.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/19.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/20.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/21.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/22.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/23.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/24.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/25.png">
<meta property="og:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/26.png">
<meta property="article:published_time" content="2023-05-13T15:26:14.000Z">
<meta property="article:modified_time" content="2023-11-21T02:59:20.634Z">
<meta property="article:author" content="Kathy-kx">
<meta property="article:tag" content="MySQL">
<meta property="article:tag" content="项目笔记">
<meta property="article:tag" content="java">
<meta property="article:tag" content="SpringBoot">
<meta property="article:tag" content="Spring">
<meta property="article:tag" content="Spring MVC">
<meta property="article:tag" content="MyBatis">
<meta property="article:tag" content="MyBatis Plus">
<meta property="article:tag" content="html">
<meta property="article:tag" content="json">
<meta property="article:tag" content="Transaction">
<meta property="article:tag" content="controller">
<meta property="article:tag" content="Vue">
<meta property="article:tag" content="DTO">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/1.png">


<link rel="canonical" href="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/","path":"2023/05/13/瑞吉外卖04-菜品管理/","title":"瑞吉外卖04-菜品管理"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>瑞吉外卖04-菜品管理 | Kathy's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Kathy's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86%E4%B8%9A%E5%8A%A1%E5%BC%80%E5%8F%91"><span class="nav-text">1. 菜品管理业务开发</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD"><span class="nav-text">1.1 文件上传下载</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-1-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%BB%8B%E7%BB%8D"><span class="nav-text">1.1.1 文件上传介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-2-%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E4%BB%8B%E7%BB%8D"><span class="nav-text">1.1.2 文件下载介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-3-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">1.1.3 文件上传代码实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-4-%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">1.1.4 文件下载代码实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-5-%E4%B8%9A%E5%8A%A1%E8%BF%87%E7%A8%8B%E6%A2%B3%E7%90%86%E6%80%BB%E7%BB%93"><span class="nav-text">1.1.5 业务过程梳理总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E6%96%B0%E5%A2%9E%E8%8F%9C%E5%93%81"><span class="nav-text">1.2 新增菜品</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="nav-text">1.2.1 需求分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-2-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="nav-text">1.2.2 数据模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-3-%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91"><span class="nav-text">1.2.3 代码开发</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E8%8F%9C%E5%93%81%E4%BF%A1%E6%81%AF%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="nav-text">1.3 菜品信息分页查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="nav-text">1.3.1 需求分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-2-%E6%A2%B3%E7%90%86%E4%BA%A4%E4%BA%92%E8%BF%87%E7%A8%8B"><span class="nav-text">1.3.2 梳理交互过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-3-%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91"><span class="nav-text">1.3.3 代码开发</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-%E4%BF%AE%E6%94%B9%E8%8F%9C%E5%93%81"><span class="nav-text">1.4 修改菜品</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="nav-text">1.4.1 需求分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-2-%E6%A2%B3%E7%90%86%E4%BA%A4%E4%BA%92%E8%BF%87%E7%A8%8B-1"><span class="nav-text">1.3.2 梳理交互过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-3-%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91"><span class="nav-text">1.4.3 代码开发</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-5-%E5%81%9C%E5%94%AE-x2F-%E5%90%AF%E5%94%AE%E8%8F%9C%E5%93%81%EF%BC%88%E6%94%AF%E6%8C%81%E6%89%B9%E9%87%8F%EF%BC%89"><span class="nav-text">1.5 停售&#x2F;启售菜品（支持批量）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="nav-text">1.5.1 需求分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-2-%E4%BA%A4%E4%BA%92%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90"><span class="nav-text">1.5.2 交互过程分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-3-%E5%90%8E%E7%AB%AF%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">1.5.3 后端代码实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-6-%E5%88%A0%E9%99%A4%E8%8F%9C%E5%93%81%EF%BC%88%E6%94%AF%E6%8C%81%E6%89%B9%E9%87%8F%EF%BC%89"><span class="nav-text">1.6 删除菜品（支持批量）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-1-%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="nav-text">1.6.1 需求分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-2-%E4%BA%A4%E4%BA%92%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90"><span class="nav-text">1.6.2 交互过程分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-3-%E5%90%8E%E7%AB%AF%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="nav-text">1.6.3 后端代码实现</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Kathy-kx</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">23</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/kathy-kx" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;kathy-kx" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:kxzhu93@163.com" title="E-Mail → mailto:kxzhu93@163.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Kathy-kx">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Kathy's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="瑞吉外卖04-菜品管理 | Kathy's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          瑞吉外卖04-菜品管理
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-05-13 23:26:14" itemprop="dateCreated datePublished" datetime="2023-05-13T23:26:14+08:00">2023-05-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-11-21 10:59:20" itemprop="dateModified" datetime="2023-11-21T10:59:20+08:00">2023-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Food-Delivery-System/" itemprop="url" rel="index"><span itemprop="name">Food Delivery System</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>本笔记源自黑马程序员的视频课程——《瑞吉外卖》，总结了<strong>课程笔记</strong>、相关<strong>知识点</strong>以及可能遇到的<strong>问题解决方案</strong>，并且<strong>增加了课程中未实现的功能</strong>，供读者参考。笔记全面且条理清晰，希望帮助读者学习和理解这个外卖项目。<br>本项目全部笔记见：<a target="_blank" rel="noopener" href="https://kathy-kx.github.io/categories/Food-Delivery-System/">外卖项目笔记合集</a></p>
<h1 id="1-菜品管理业务开发"><a href="#1-菜品管理业务开发" class="headerlink" title="1. 菜品管理业务开发"></a>1. <strong><strong>菜品管理业务开发</strong></strong></h1><h2 id="1-1-文件上传下载"><a href="#1-1-文件上传下载" class="headerlink" title="1.1 文件上传下载"></a>1.1 <strong><strong>文件上传下载</strong></strong></h2><h3 id="1-1-1-文件上传介绍"><a href="#1-1-1-文件上传介绍" class="headerlink" title="1.1.1 文件上传介绍"></a>1.1.1 <strong><strong>文件上传介绍</strong></strong></h3><p>文件上传，也称为upload，是指将本地图片、视频、音频等文件上传到服务器上，可以供其他用户浏览或下载的过程。文件上传在项目中应用非常广泛，我们经常发微博、发微信朋友圈都用到了文件上传功能。</p>
<p>文件上传时，需要使用form表单上传文件，且对页面的form表单有如下要求：</p>
<ul>
<li>method&#x3D;”post”　method为post</li>
<li>enctype&#x3D;”multipart&#x2F;form-data”　form表单的enctype属性值为”multipart&#x2F;form-data”</li>
<li>type&#x3D;”file”　form标签中使用input type&#x3D;”file”添加上传的文件</li>
</ul>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/1.png" alt="1"></p>
<p>目前一些前端组件库也提供了相应的上传组件，但是底层原理还是基于form表单的文件上传。例如ElementUI中提供的upload上传组件：</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/2.png" alt="2"></p>
<p>服务端要接收客户端页面上传的文件，通常都会使用Apache的两个组件:</p>
<ul>
<li>commons-fileupload</li>
<li>commons-io</li>
</ul>
<p>Spring框架在spring-web包中对“文件上传”进行了封装，大大简化了服务端代码。</p>
<p>我们只需要在Controller的方法中，声明一个MultipartFile类型的参数，即可接收上传的文件。</p>
<p>步骤为：</p>
<p>1、新建一个控制器类CommonController，专门负责文件上传和下载</p>
<p>2、在upload()方法的形参位置，声明MultipartFile类型的参数，对象名与「html页面传来的form表单中的name」一致，也就是和浏览器请求体form-data处的name值一致。</p>
<p>具体实现在1.1.3中。</p>
<h3 id="1-1-2-文件下载介绍"><a href="#1-1-2-文件下载介绍" class="headerlink" title="1.1.2 文件下载介绍"></a>1.1.2 <strong>文件下载介绍</strong></h3><p>文件下载，也称为download，是指将文件从服务器传输到本地计算机的过程。通过浏览器进行文件下载，通常有两种表现形式:</p>
<span id="more"></span>
<ul>
<li>以附件形式下载，弹出保存对话框，将文件保存到指定磁盘目录</li>
<li>直接在浏览器中打开</li>
</ul>
<p>通过浏览器进行文件下载，本质上就是服务端将文件以流的形式写回浏览器的过程。</p>
<h3 id="1-1-3-文件上传代码实现"><a href="#1-1-3-文件上传代码实现" class="headerlink" title="1.1.3 文件上传代码实现"></a>1.1.3 <strong>文件上传代码实现</strong></h3><p>文件上传，页面端可以使用ElementUI提供的上传组件。</p>
<!--more-->
<p>可以直接使用资料中提供的上传页面，位置：资料&#x2F;文件上传下载页面&#x2F;upload.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>文件上传<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 引入样式 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;../../plugins/element-ui/index.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;../../styles/common.css&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;../../styles/page.css&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;shortcut icon&quot;</span> <span class="attr">href</span>=<span class="string">&quot;../../favicon.ico&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;addBrand-container&quot;</span> <span class="attr">id</span>=<span class="string">&quot;food-add-app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-upload</span> <span class="attr">class</span>=<span class="string">&quot;avatar-uploader&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">action</span>=<span class="string">&quot;/common/upload&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:show-file-list</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:on-success</span>=<span class="string">&quot;handleAvatarSuccess&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:before-upload</span>=<span class="string">&quot;beforeUpload&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">ref</span>=<span class="string">&quot;upload&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">v-if</span>=<span class="string">&quot;imageUrl&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;imageUrl&quot;</span> <span class="attr">class</span>=<span class="string">&quot;avatar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">img</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">i</span> <span class="attr">v-else</span> <span class="attr">class</span>=<span class="string">&quot;el-icon-plus avatar-uploader-icon&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 开发环境版本，包含了有帮助的命令行警告 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../../plugins/vue/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引入组件库 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../../plugins/element-ui/index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引入axios --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../../plugins/axios/axios.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../../js/index.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&#x27;#food-add-app&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">imageUrl</span>: <span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">          handleAvatarSuccess (response, file, fileList) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="variable language_">this</span>.<span class="property">imageUrl</span> = <span class="string">`/common/download?name=<span class="subst">$&#123;response.data&#125;</span>`</span></span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          beforeUpload (file) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(file)&#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">const</span> suffix = file.<span class="property">name</span>.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>)[<span class="number">1</span>]</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">const</span> size = file.<span class="property">size</span> / <span class="number">1024</span> / <span class="number">1024</span> &lt; <span class="number">2</span></span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">if</span>([<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;jpeg&#x27;</span>,<span class="string">&#x27;jpg&#x27;</span>].<span class="title function_">indexOf</span>(suffix) &lt; <span class="number">0</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&#x27;上传图片只支持 png、jpeg、jpg 格式！&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">upload</span>.<span class="title function_">clearFiles</span>()</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">              &#125;</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">if</span>(!size)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&#x27;上传文件大小不能超过 2MB!&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> <span class="literal">false</span></span></span><br><span class="line"><span class="language-javascript">              &#125;</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">return</span> file</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>新增CommonController，负责文件上传与下载。</p>
<p>接收上传的文件<strong>步骤</strong>：</p>
<p>1、新建一个控制器类CommonController，专门负责文件上传和下载</p>
<p>2、在upload()方法的形参位置，声明MultipartFile类型的参数，对象名与「html页面传来的form表单中的name」一致，也就是和浏览器请求体form-data处的name值一致。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/common&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonController</span> &#123;</span><br><span class="line">    <span class="comment">//文件上传</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> R&lt;String&gt; <span class="title function_">upload</span><span class="params">(MultipartFile file)</span>&#123;</span><br><span class="line">        <span class="comment">//file 是一个临时文件，需要转存到指定位置，否则请求完成后临时文件会删除</span></span><br><span class="line">        log.info(<span class="string">&quot;file:&#123;&#125;&quot;</span>,file.toString());</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：MultipartFile定义的file变量必须与name一致</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/3.png" alt="3"></p>
<p><strong>完整代码</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/common&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonController</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;reggie.path&#125;&quot;)</span> <span class="comment">//注解@Value 是org.springframework.beans.factory.annotation包下的。可以将配置文件中的值赋值给Java对象中的属性。</span></span><br><span class="line">		<span class="comment">//此处将配置文件中定义的reggie.path属性值注入给basePath</span></span><br><span class="line">    <span class="keyword">private</span> String basePath;</span><br><span class="line"></span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件上传</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file 类型为MultipartFile。名字和(浏览器请求体form-data处的)name值一致</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> R&lt;String&gt; <span class="title function_">upload</span><span class="params">(MultipartFile file)</span>&#123;</span><br><span class="line">        <span class="comment">//log.info(&quot;file:&#123;&#125;&quot;,file.toString());</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//文件名：随机UUID名(避免重名造成覆盖) + 后缀</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">originalFilename</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">        <span class="type">String</span> <span class="variable">suffix</span> <span class="operator">=</span> originalFilename.substring(originalFilename.lastIndexOf(<span class="string">&quot;.&quot;</span>)); <span class="comment">//substring(int index)方法：返回从index处(含)至末尾(含)的子串</span></span><br><span class="line">        <span class="comment">//使用UUID随机生成文件名，防止因为文件名相同造成文件覆盖</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> UUID.randomUUID().toString()+suffix;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建一个目录对象</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">dir</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(basePath);</span><br><span class="line">        <span class="comment">//判断当前目录是否存在</span></span><br><span class="line">        <span class="keyword">if</span>(!dir.exists())&#123;</span><br><span class="line">            <span class="comment">//目录不存在</span></span><br><span class="line">            dir.mkdirs(); <span class="comment">//创建目录（含所有不存在的parent目录）</span></span><br><span class="line">						<span class="comment">//mkdir(): 创建目录。如果父目录不存在/当前目录已存在，则创建失败</span></span><br><span class="line">            <span class="comment">//mkdirs(): 创建目录。如果父目录不存在，也同时创建父目录。</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">//file 是一个临时文件，需要转存到指定位置，否则请求完成后临时文件会删除</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//将临时文件转存到指定位置</span></span><br><span class="line">            file.transferTo(<span class="keyword">new</span> <span class="title class_">File</span>(basePath+fileName));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> R.success(fileName); <span class="comment">//前端需要</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置文件application.yml中，配置指定位置：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#自定义参数。文件上传时，上传到指定位置</span></span><br><span class="line"><span class="attr">reggie:</span></span><br><span class="line">  <span class="attr">path:</span> <span class="string">/Users/kathy/Downloads/img_upload/</span></span><br></pre></td></tr></table></figure>

<h3 id="1-1-4-文件下载代码实现"><a href="#1-1-4-文件下载代码实现" class="headerlink" title="1.1.4 文件下载代码实现"></a>1.1.4 <strong>文件下载代码实现</strong></h3><p>通过浏览器进行文件下载，本质就是：将文件从服务端，以流的形式，写入到浏览器的过程。</p>
<p><strong>前端html页面</strong>中：</p>
<p>(1)在el-upload标签内，通过此标签展示下载的图片：（用img标签，指定src属性，会向src中的地址发送请求。）</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/4.png" alt="4"></p>
<p>(2)methods中：</p>
<p>:on-success&#x3D;”handleAvatarSuccess”：文件上传success后，同时回调handleAvatarSuccess方法。如下：</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/5.png" alt="5"></p>
<p><strong>后端controller代码</strong>：</p>
<p>文件上传完成后，回调handleAvatarSuccess方法，即紧接着发送&#x2F;common&#x2F;download请求，并将name传给服务器。</p>
<p>服务端收到&#x2F;common&#x2F;download?name&#x3D;xxxxx请求后，会执行以下方法。到指定目录下，通过输入流读取name这个文件。再通过输出流写给浏览器。浏览器就可以显示刚上传的图片。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文件下载</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/download&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">download</span><span class="params">(String name, HttpServletResponse response)</span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//输入流，通过输入流读取文件内容</span></span><br><span class="line">        FileInputStream fileInputStream=<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="keyword">new</span> <span class="title class_">File</span>(basePath+name)); <span class="comment">//basePath + name是要读取的文件</span></span><br><span class="line">        <span class="comment">//输出流，通过输出流将文件写回浏览器（用response），在浏览器中展示图片</span></span><br><span class="line">        <span class="type">ServletOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//读到哪去：</span></span><br><span class="line">        <span class="type">int</span> len=<span class="number">0</span>;</span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="keyword">while</span> ((len=fileInputStream.read(bytes))!=-<span class="number">1</span>)&#123;</span><br><span class="line">            outputStream.write(bytes,<span class="number">0</span>,len);</span><br><span class="line">            outputStream.flush();</span><br><span class="line">        &#125;</span><br><span class="line">        outputStream.close();<span class="comment">//fileInputStream &amp; outputStream是局部变量，只能在try中关。不能在finally中关</span></span><br><span class="line">        fileInputStream.close();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>说明：</p>
<p>1、返回值是void：通过输出流，向浏览器写回二进制数据即可，不需要返回值</p>
<p>2、参数：name：获取请求参数name。response：输出流需要通过response来获得</p>
<h3 id="1-1-5-业务过程梳理总结"><a href="#1-1-5-业务过程梳理总结" class="headerlink" title="1.1.5 业务过程梳理总结"></a>1.1.5 业务过程梳理总结</h3><p><strong>后端</strong></p>
<ul>
<li><p><strong>上传</strong></p>
<p>  1、浏览器访问localhost:8080&#x2F;backend&#x2F;page&#x2F;demo&#x2F;upload.html页面，选择图片上传后，会发送POST请求到<a target="_blank" rel="noopener" href="http://localhost:8080/common/upload">http://localhost:8080/common/upload</a> ，由controller处理。</p>
<p>  2、controller中的upload方法处理该post请求。通过MultipartFile类型的形参，接收上传的文件。</p>
<p>  （上传文件时，elementUI会自动生成<code>&quot;Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;fileName.jpeg&quot; &quot;</code>  注意此处的name，要和控制器方法形参同名。而类型固定为MultipartFile，这样就可以使用spring框架封装的代码）</p>
<p>  3、upload()方法还要生成文件名fileName、将临时文件file转存到服务器指定位置。在转存前还需要检查该文件目录是否存在（如不存在，就要创建），最后返回文件名给前端（封装在R中）。</p>
</li>
<li><p><strong>下载</strong></p>
<p>  1、前端发出下载请求&#x2F;common&#x2F;download?name&#x3D;${response.data}，带着文件名参数来服务器，由controller中的download方法处理。</p>
<p>  2、到服务器的指定目录下（basePath+filename），通过输入流读取文件到输入流对象fileInputStream，再通过响应response得到输出流对象outputStream 将文件写回浏览器。</p>
</li>
</ul>
<p><strong>前端</strong></p>
<ul>
<li><p><strong>上传</strong></p>
<p>  el-upload是elementUI提供的【上传组件】</p>
<p>  指定action&#x3D;”&#x2F;common&#x2F;upload”，所以选择图片上传后，会发POST请求到&#x2F;common&#x2F;upload，由控制器处理。（控制器处理后，会响应filename文件名回来）</p>
</li>
<li><p><strong>下载</strong></p>
<p>  <code>:on-success=&quot;handleAvatarSuccess&quot;</code>：文件上传success后，接到服务器的响应 R.success(filename)，同时回调<code>handleAvatarSuccess</code>方法，发送下载请求&#x2F;common&#x2F;download?name&#x3D;${response.data}。其中response.data是服务器刚响应回来的R对象中封装的filename。</p>
<p>  接下来由img标签展示下载下来的图片，来源是imageUrl，它是请求&#x2F;common&#x2F;download?name&#x3D;${response.data}由服务器处理后的结果（即通过输出流，响应到浏览器的图片）由img标签展示。</p>
</li>
</ul>
<h2 id="1-2-新增菜品"><a href="#1-2-新增菜品" class="headerlink" title="1.2 新增菜品"></a>1.2 <strong><strong>新增菜品</strong></strong></h2><h3 id="1-2-1-需求分析"><a href="#1-2-1-需求分析" class="headerlink" title="1.2.1 需求分析"></a>1.2.1 需求分析</h3><p>后台系统中可以管理菜品信息，通过新增功能来添加一个新的菜品，在添加菜品时需要选择当前菜品所属的菜品分类,并且需要上传菜品图片，在移动端会按照菜品分类来展示对应的菜品信息。</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/6.png" alt="图片"></p>
<h3 id="1-2-2-数据模型"><a href="#1-2-2-数据模型" class="headerlink" title="1.2.2 数据模型"></a>1.2.2 <strong>数据模型</strong></h3><p>新增菜品，其实就是将新增页面录入的菜品信息插入到dish表。如果添加了口味做法，还需要向dish_flavor表插入数据。所以在新增菜品时，涉及到两个表：</p>
<p>1、dish表（菜品表）</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/7.png" alt="图片"></p>
<p>2、dish_flavor表（菜品口味表）</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/8.png" alt="图片"></p>
<h3 id="1-2-3-代码开发"><a href="#1-2-3-代码开发" class="headerlink" title="1.2.3 代码开发"></a>1.2.3 <strong>代码开发</strong></h3><p><strong>准备工作：</strong></p>
<p>在开发业务功能前，先将需要用到的类和接口基本结构创建好。</p>
<p>1、实体类DishFlavor(直接从课程资料中导入。Dish实体类前面课程中已经导入过了)</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishFlavor</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">		</span><br><span class="line">	<span class="comment">//主键</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//菜品id</span></span><br><span class="line">    <span class="keyword">private</span> Long dishId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//口味名称</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//口味数据list</span></span><br><span class="line">    <span class="keyword">private</span> String value;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createTime;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line">    <span class="keyword">private</span> Long createUser;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line">    <span class="keyword">private</span> Long updateUser;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//是否删除</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDeleted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2、Mapper接口DishFlavorMapper</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DishFlavorMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;DishFlavor&gt; &#123;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>3、Service接口DishFlavorService</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DishFlavorService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;DishFlavor&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>4、Service接口实现类 DishFlavorServicelmpl</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishFlavorServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;DishFlavorMapper, DishFlavor&gt;<span class="keyword">implements</span> <span class="title class_">DishFlavorService</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>5、控制层 DishController</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/dish&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishService dishService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishFlavorService dishFlavorService;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>梳理交互过程</strong></p>
<p>在开发代码之前，需要梳理一下新增菜品时，前端页面和服务端的交互过程：</p>
<p>1、页面(backend&#x2F;page&#x2F;food&#x2F;add.html)发送ajax请求，请求服务端获取菜品分类数据并展示到下拉框中</p>
<p>这一步的具体过程：</p>
<p>点击“新建菜品”，访问backend&#x2F;page&#x2F;food&#x2F;add.html页面，会执行created()钩子函数，其中执行this.getDishList()方法。getDishList()中，执行getCategoryList()，该方法向&#x2F;category&#x2F;list发送ajax请求，请求类型是GET，params是type&#x3D;1。</p>
<p>所以，页面一加载完，会发送请求：&#x2F;category&#x2F;list?type&#x3D;1，以获取所有的分类信息（之前添加的菜品分类），回显到下拉菜单中。</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/9.png" alt="图片"></p>
<p>2、页面发送请求进行图片上传，请求服务端将图片保存到服务器</p>
<p>3、页面发送请求进行图片下载，将上传的图片进行回显</p>
<p>2、3 这两步的具体过程：</p>
<p>菜品图片上传和下载模块：点击+ 进行图片上传，向&#x2F;common&#x2F;upload发送POST请求，将图片上传至服务器某路径保存。紧接着在页面回显，向&#x2F;common&#x2F;download?name&#x3D;xxxx发送GET请求，将图片从服务器以流的方式，写入到浏览器。2、3这两步在前面已经写过了，可以直接用。</p>
<p>4、点击“保存”按钮，发送ajax请求，将菜品相关数据以json形式提交到服务端</p>
<p>这一步的具体过程：</p>
<p>填完表单，点击“保存”，会先校验，校验通过后，把整个表单的数据收集起来，封装到params。然后执行addDish(params)方法，发送ajax请求到&#x2F;dish，method&#x3D;post，将填的params数据以json形式发给服务器，让服务器保存。所以控制器方法应该能够接收提交的表单中的这些数据params，并保存到数据表。</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/10.png" alt="图片"></p>
<p>开发新增菜品功能，其实就是在服务端编写代码去处理前端页面发送的这4次请求即可。</p>
<p><strong>后端程序开发</strong></p>
<p>1、菜品分类下拉框回显</p>
<p>前端要获取所有的分类，以展示在下拉框。前端发送请求：&#x2F;category&#x2F;list?type&#x3D;1，需要服务器处理并给出响应。所以我们在CategoryController控制器新建list()方法，处理该请求。</p>
<p>该方法中，需要在数据库的category表中，根据type查询所有的分类。并将查出的分类list响应给前端。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据条件查询分类数据 为list</span></span><br><span class="line"><span class="comment"> * 请求是/category/list?type=1</span></span><br><span class="line"><span class="comment"> * 在添加菜品的时候，需要为菜品添加一个分类。需要在下拉菜单中显示所有已经创建好的分类。</span></span><br><span class="line"><span class="comment"> * type=1 菜品分类；type=2 套餐分类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line"><span class="keyword">public</span> R&lt;List&lt;Category&gt;&gt; <span class="title function_">list</span><span class="params">(Category category)</span>&#123;</span><br><span class="line">		<span class="comment">//从表中查询所有的分类：select * from category where type = ? (type使用参数传来的type值)</span></span><br><span class="line">    <span class="comment">//条件构造器</span></span><br><span class="line">    LambdaQueryWrapper&lt;Category&gt; lambdaQueryWrapper=<span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//添加条件</span></span><br><span class="line">    lambdaQueryWrapper.eq(category.getType()!=<span class="literal">null</span>,Category::getType,category.getType());</span><br><span class="line">    <span class="comment">//添加排序条件</span></span><br><span class="line">    lambdaQueryWrapper.orderByAsc(Category::getSort).orderByAsc(Category::getUpdateTime);</span><br><span class="line">    List&lt;Category&gt; list = categoryService.list(lambdaQueryWrapper);</span><br><span class="line">    <span class="keyword">return</span> R.success(list); <span class="comment">//将查询出的list作为data，封装在R对象中</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>2、菜品图片上传和下载方法已经写过，可以直接调用。</p>
<p>3、管理员填完表单，点击保存，会发送ajax请求到&#x2F;dish，method&#x3D;post，将填的params数据以json形式发给服务器。服务器（控制器方法）如何接收这些参数呢？</p>
<p>浏览器传来的json数据中，name、price、code、image、description、status、categoryId这些属性，在Dish实体类中都有属性与之对应。但是flavors这一项，Dish类中没有该属性对应，无法在形参中用实体类Dish+@RequestBody注解的方式接收请求参数。</p>
<p>解决办法：可以封装另一个类DishDto，继承Dish的所有属性，还另扩展了其他属性(flavors等)，接收所有的这些参数。</p>
<p>我们先导入DishDto（位置：资料&#x2F;dto)，用于封装页面提交的数据。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishDto</span> <span class="keyword">extends</span> <span class="title class_">Dish</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;DishFlavor&gt; flavors = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String categoryName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer copies;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>DTO，全称为Data Transfer object，即数据传输对象，一般用于展示层与服务层之间的数据传输。</p>
<p>接下来控制器方法就可以声明DishDto类型的形参，接收到dish表需要的参数和flavors参数。然后执行service层的方法。</p>
<p>但由于原本dishService中的save()方法只能操作dish表。我们新增菜品同时插入菜品对应的口味数据，还需要操作dish_flavor表，添加菜品对应的口味信息。所以需要在service层重新声明<code>saveWithFlavor(DishDto dishDto)</code>方法，将Dish类的属性保存到dish表，将DishFlavor类的属性保存到dish_flavor表。</p>
<p>在DishService接口中添加方法saveWithFlavor(DishDto dishDto)，在DishServiceImpl实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DishServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;DishMapper, Dish&gt; <span class="keyword">implements</span> <span class="title class_">DishService</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DishFlavorService dishFlavorService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional</span> <span class="comment">//涉及多张表，所以使用事务。还需要在主程序加@EnableTransactionManagement，以启用事务</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveWithFlavor</span><span class="params">(DishDto dishDto)</span> &#123;</span><br><span class="line">        <span class="comment">//保存菜品基本信息到菜品表dish</span></span><br><span class="line">        <span class="built_in">this</span>.save(dishDto);<span class="comment">//DishDto继承自Dish，所以dishDto中封装了菜品表中所需的信息。但是dishDto的扩展部分还没保存</span></span><br><span class="line">				<span class="comment">//save(dishDto)保存菜品后，雪花算法自动生成菜品的id（Dish类的id属性），插入到数据库。mybatis plus帮我们自动返回主键。</span></span><br><span class="line"></span><br><span class="line">        <span class="type">Long</span> <span class="variable">dishid</span> <span class="operator">=</span> dishDto.getId();<span class="comment">//获得菜品id</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//菜品口味</span></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">思路：</span></span><br><span class="line"><span class="comment">前端传来的&quot;flavors&quot;:[&#123;&quot;name&quot;:&quot;甜味&quot;,&quot;value&quot;:&quot;[\&quot;无糖\&quot;,\&quot;少糖\&quot;,\&quot;半糖\&quot;,\&quot;多糖\&quot;,\&quot;全糖\&quot;]&quot;</span></span><br><span class="line"><span class="comment">flavors是用List集合盛装DishFlavor对象。前端传来的只有DishFlavor的name和value，还缺DishFlavor类中的dishId。此处必须给flavors信息加上dishId数据，否则不知道添加的口味（name和value）是哪个菜的，无法对应。</span></span><br><span class="line"><span class="comment">dish_flavor表中的dish_id对应dish表中的id。所以可以先获取dish表的id（从dishDto获取），再将这个id加到集合中，并插入到dish_flavor表中。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//此处用流的方式（也可以用for i循环），将信息封装到item中，给item添加上菜品id，再转成集合，重新赋值给flavors这个集合</span></span><br><span class="line">        List&lt;DishFlavor&gt; flavors = dishDto.getFlavors();</span><br><span class="line">        flavors = flavors.stream().map( (item) -&gt;&#123;  <span class="comment">//item：遍历出的每一项，对应一个DishFlavor实体</span></span><br><span class="line">            item.setDishId(dishId); <span class="comment">//加工每一个item，把item的属性dishId赋好值</span></span><br><span class="line">            <span class="keyword">return</span> item;</span><br><span class="line">        &#125;).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//保存菜品口味到菜品数据表dish_flavor</span></span><br><span class="line">        dishFlavorService.saveBatch(flavors);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由于涉及多表操作，需要在启动类上开启事务，添加<code>@EnableTransactionManagement</code>注解。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ServletComponentScan</span>   <span class="comment">//加上这个注解后，才会扫描@WebFilter注解，使得过滤器生效</span></span><br><span class="line"><span class="meta">@Slf4j</span>  </span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span> <span class="comment">//和@Transactional一起，开启事务</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReggieApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(TimingFoodDeliveryApplication.class, args);</span><br><span class="line">        log.info(<span class="string">&quot;项目启动成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在控制器DishController中，新增save()方法，调用刚才写好的Service方法，新增菜品。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span></span><br><span class="line"><span class="keyword">public</span> R&lt;String&gt; <span class="title function_">save</span><span class="params">(<span class="meta">@RequestBody</span> DishDto dishDto)</span>&#123;</span><br><span class="line">    dishService.saveWithFlavor(dishDto);</span><br><span class="line">    <span class="keyword">return</span> R.success(<span class="string">&quot;新增菜品成功&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-3-菜品信息分页查询"><a href="#1-3-菜品信息分页查询" class="headerlink" title="1.3 菜品信息分页查询"></a>1.3 <strong>菜品信息分页查询</strong></h2><h3 id="1-3-1-需求分析"><a href="#1-3-1-需求分析" class="headerlink" title="1.3.1 需求分析"></a>1.3.1 <strong>需求分析</strong></h3><p>系统中的菜品数据很多的时候，如果在一个页面中全部展示出来会显得比较乱，不便于查看，所以一般系统中都会以分页的方式来展示列表数据。</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/11.png" alt="图片"></p>
<h3 id="1-3-2-梳理交互过程"><a href="#1-3-2-梳理交互过程" class="headerlink" title="1.3.2 梳理交互过程"></a>1.3.2 <strong>梳理交互过程</strong></h3><p>在开发代码之前，需要梳理一下菜品分页查询时前端页面和服务端的交互过程:</p>
<p>1、页面(backend&#x2F;page&#x2F;food&#x2F;list.html)发送ajax请求，将分页查询参数(page、pageSize、name)提交到服务端，获取分页数据。</p>
<p>这一步的具体过程：</p>
<p>点“菜品管理”，访问backend&#x2F;page&#x2F;food&#x2F;list.html，页面加载完会立即发送ajax请求，向服务器发请求&#x2F;dish&#x2F;page?page&#x3D;xx&amp;pageSize&#x3D;x&amp;name&#x3D;xxx。由服务器controller处理、查询后，响应回来，得到菜品分页数据（含菜品名称、菜品分类、售价、售卖状态、最后操作时间、操作）。</p>
<p>页面加载完立即发送ajax请求是如何实现的：页面加载完，执行钩子函数。执行init()方法。init()方法中，(1)封装了params；(2)执行getDishPage(params)，发送ajax请求(请求”&#x2F;dish&#x2F;page?page&#x3D;xx&amp;pageSize&#x3D;x&amp;name&#x3D;xxx”，需要服务器处理，并响应page对象给前端）</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/12.png" alt="图片"></p>
<p>2、页面发送请求&#x2F;common&#x2F;download?name&#x3D;${image}，请求服务端进行图片下载，用于页面图片展示。此功能前面已经写过了。</p>
<h3 id="1-3-3-代码开发"><a href="#1-3-3-代码开发" class="headerlink" title="1.3.3 代码开发"></a>1.3.3 <strong>代码开发</strong></h3><p>需要处理请求&#x2F;dish&#x2F;page?page&#x3D;xx&amp;pageSize&#x3D;x&amp;name&#x3D;xxx，从数据库查询出分页数据pageInfo，并封装到R对象中，响应给前端。</p>
<p>但是pageInfo是Page<Dish>类型的，只包含dish表的字段，只有”category_id”字段，没有“菜品分类”名称，“category_name”只在category表中。因此还需要通过”category_id”，去category表中查询“category_name”。</p>
<p>DishController中：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/page&quot;)</span></span><br><span class="line"><span class="keyword">public</span> R&lt;Page&gt; <span class="title function_">page</span><span class="params">(<span class="type">int</span> page, <span class="type">int</span> pageSize, String name)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//分页构造器</span></span><br><span class="line">    Page&lt;Dish&gt; pageInfo = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(page, pageSize);</span><br><span class="line">    Page&lt;DishDto&gt; dishDtoPage = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//条件构造器</span></span><br><span class="line">    LambdaQueryWrapper&lt;Dish&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//添加查询条件（模糊查询）：只要name不为空，就在Dish表中根据name字段查询，要查的值是传来的参数name</span></span><br><span class="line">    queryWrapper.like(StringUtils.isNotEmpty(name), Dish::getName, name);</span><br><span class="line">    <span class="comment">//添加排序条件</span></span><br><span class="line">    queryWrapper.orderByDesc(Dish::getUpdateTime);</span><br><span class="line">    <span class="comment">//执行分页查询（用dishService查dish表）</span></span><br><span class="line">    dishService.page(pageInfo, queryWrapper); <span class="comment">//处理好会封装到Page类型的pageInfo中，pageInfo中含有数据列表records、总记录数total等信息</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//原先：return R.success(pageInfo); 此分页对象是关于dish的，dish表中的菜品分类只是category_id，而页面需要的是分类名字，因此无法正常展示&quot;菜品分类&quot;。</span></span><br><span class="line">    <span class="comment">//所以此处不能直接返回。需要改造，额外返回category_id对应的分类名categoryName。查看list.html也能看出，需要后端响应名为&quot;categoryName&quot;的字段，才能显示&quot;菜品分类&quot;这一项</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// dishDtoPage构建后没有赋值，如何赋值？</span></span><br><span class="line">    <span class="comment">//（1）可以直接把 从dish表中查出的pageInfo各属性值 拷贝给dishDtoPage（除records）</span></span><br><span class="line">    <span class="comment">//（2）再把records转换为DishDto类型的，添加上categoryName，设置给dishDtoPage</span></span><br><span class="line">    <span class="comment">//第（1）步：对象拷贝</span></span><br><span class="line">    BeanUtils.copyProperties(pageInfo, dishDtoPage, <span class="string">&quot;records&quot;</span>);<span class="comment">//不拷贝records属性（页面上的数据信息就是records，需要处理）</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//第（2）步：处理records</span></span><br><span class="line">    List&lt;Dish&gt; records = pageInfo.getRecords(); <span class="comment">//把pageInfo里的records属性的值拿出来。</span></span><br><span class="line"></span><br><span class="line">    List&lt;DishDto&gt; list = records.stream().map((item)-&gt;&#123; <span class="comment">//item：遍历出的每一个菜品对象dish</span></span><br><span class="line">        <span class="type">DishDto</span> <span class="variable">dishDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DishDto</span>();</span><br><span class="line">        BeanUtils.copyProperties(item, dishDto);<span class="comment">//把dish的普通属性copy给我们自己创建的dishDto对象</span></span><br><span class="line">        <span class="type">Long</span> <span class="variable">categoryId</span> <span class="operator">=</span> item.getCategoryId();<span class="comment">//获取当前遍历到的dish对象的categoryId</span></span><br><span class="line">        <span class="comment">//根据id，从数据库查询分类对象，以获取分类名称</span></span><br><span class="line">        <span class="type">Category</span> <span class="variable">category</span> <span class="operator">=</span> categoryService.getById(categoryId);</span><br><span class="line">        <span class="keyword">if</span>(category != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">categoryName</span> <span class="operator">=</span> category.getName();<span class="comment">//获取分类名称</span></span><br><span class="line">            dishDto.setCategoryName(categoryName);<span class="comment">//把categoryName赋值给 我们自己创建的dishDto对象的 categoryName属性</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dishDto;</span><br><span class="line">    &#125;).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">    dishDtoPage.setRecords(list);<span class="comment">//把加了categoryName的新list 赋值给dishDtoPage的records属性</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> R.success(dishDtoPage);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面第(2)步的解释梳理：</p>
<p>records是List类型（盛装Dish对象），那就可以用流来表示。records.stream()将List类型的records转换为流，流中有多个Dish对象。遍历流中的每一个Dish对象，称为item。</p>
<p>我们想让流中存放的一个个对象中，不仅含dish表中查出的数据，还含category表中查出的category_name数据。于是在DishDto类中添加categoryName属性，以便封装category_name数据。</p>
<p>可以理解为，我们想将流中的每一个dish对象 换成一个dishDto对象，其中存有dish的属性值，还存了category_name值。</p>
<p>所以对于每个item，我们新创建一个dishDto对象去替换原来的dish对象。</p>
<ul>
<li>先将item（dish对象）的属性值copy给新造的dishDto对象。此时dishDto中除了categoryName属性，其他都有了</li>
<li>接下来去数据库查该对象。通过item.getCategoryId()，获取dish对象中的category_id属性值，用这个id去category表中查出对应的category对象，再获取到该category对象的name。</li>
<li>将获取到的categoryName赋值给dishDto对象的categoryName属性。</li>
<li>最后将dishDto对象返回，则流中都是一个个dishDto对象了。</li>
</ul>
<p>最后使用collect(Collectors.toList())方法，将流转换回List集合list，再赋给dishDtoPage分页对象的records属性。这样records中装的是DishDto对象，包含categoryName数据。</p>
<h2 id="1-4-修改菜品"><a href="#1-4-修改菜品" class="headerlink" title="1.4 修改菜品"></a>1.4 <strong>修改菜品</strong></h2><h3 id="1-4-1-需求分析"><a href="#1-4-1-需求分析" class="headerlink" title="1.4.1 需求分析"></a>1.4.1 <strong>需求分析</strong></h3><p>在菜品管理列表页面点击“修改”按钮，跳转到修改菜品页面，在修改页面回显菜品相关信息，并进行修改，最后点击“确定”按钮完成修改。</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/13.png" alt="图片"></p>
<h3 id="1-3-2-梳理交互过程-1"><a href="#1-3-2-梳理交互过程-1" class="headerlink" title="1.3.2 梳理交互过程"></a>1.3.2 <strong>梳理交互过程</strong></h3><p>在开发代码之前，需要梳理一下修改菜品时，前端页面(add.html)和服务端的交互过程：</p>
<p>1、页面发送ajax请求，请求服务端获取分类数据，用于菜品分类下拉框中数据展示。</p>
<p>这一步的具体过程：</p>
<p>“修改菜品”的页面复用了“新建菜品”时的页面，访问backend&#x2F;page&#x2F;food&#x2F;add.html?id&#x3D;(传入的参数id)后，页面加载完会执行getDishList()方法，其中执行getCategoryList()方法，发送ajax请求，向服务器发请求&#x2F;category&#x2F;list?type&#x3D;1，请求类型是GET，以获取所有的分类（之前添加的菜品分类）回显到下拉菜单中。</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/14.png" alt="图片"></p>
<p>此处服务器的处理已在CategoryController中实现过了。可以获取所有的分类信息，回显到下拉菜单中。</p>
<p>2、页面发送ajax请求，请求服务端，根据id查询当前菜品信息，用于菜品信息回显</p>
<p>这一步的具体过程：</p>
<p>与第1步同时，在访问backend&#x2F;page&#x2F;food&#x2F;add.html?id&#x3D;(传入的参数id)后，页面加载完还会立即发送ajax请求，向服务器发请求<code>/dish/$&#123;id&#125;</code>，method为GET，以获取该id对应的菜品数据。以回显到前端修改页面add.html?id&#x3D;(传入的参数id)中。</p>
<p>具体实现方法是：created()钩子函数中，取出url中参数id的值，如果url中有id，说明当前是修改的请求，执行init()方法。其中执行queryDishById(this.id)方法，向<code>/dish/$&#123;id&#125;</code> 发送get请求。需要服务器处理，查询该id的菜品信息，并需要服务器响应该id的菜品的价格、售卖状态、图片、菜品口味等数据，将服务器响应回来的菜品数据回显到修改的页面中。</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/15.png" alt="图片"></p>
<p>3、页面发送请求，请求服务端进行图片下载，用于页图片回显</p>
<p>4、点击“保存”按钮，页面发送ajax请求到<code>/dish</code>，method&#x3D;PUT，将（修改后的）该id的菜品的价格、售卖状态、图片、菜品口味等数据，以json形式提交到服务端由服务器处理该请求，将修改后的数据保存到数据库，并返回响应信息。</p>
<h3 id="1-4-3-代码开发"><a href="#1-4-3-代码开发" class="headerlink" title="1.4.3 代码开发"></a>1.4.3 <strong>代码开发</strong></h3><p>上述第1、3步已经在前面实现了。下面开发第2、4步。</p>
<p><strong>第2步</strong>：后端需要从表中查询该id对应的菜品数据（该id的菜品的 价格、售卖状态、图片、菜品口味 等），并返回这些数据给前端回显。</p>
<p>1、DishController处理GET请求</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 菜品修改-查询id对应的菜品信息（封装到dishDto对象），以回显到前端修改页面</span></span><br><span class="line"><span class="comment"> * 处理前端发来的GET请求/dish/&#123;id&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> R&lt;DishDto&gt; <span class="title function_">queryDish</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span>&#123;</span><br><span class="line">    <span class="type">DishDto</span> <span class="variable">dishDto</span> <span class="operator">=</span> dishService.getByIdWithFlavor(id);</span><br><span class="line">    <span class="keyword">return</span> R.success(dishDto);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>说明：</p>
<p>为什么不直接用<code>Dish dish = dishService.getById(id);</code> ？因为这样只能查到dish表中的数据，还需要显示菜品口味，所以使用dishDto，查dish_flavor表中的数据。</p>
<p>2、在DishService中新增getByIdWithFlavor方法，并在DishServiceImpl中实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据id，从dish表和dish_flavor表中查询菜品信息（含菜品口味）</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@Transactional</span> <span class="comment">//涉及多张表，所以使用事务。还需要在主程序加@EnableTransactionManagement，以启用事务</span></span><br><span class="line"><span class="keyword">public</span> DishDto <span class="title function_">getByIdWithFlavor</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">    <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> <span class="built_in">this</span>.getById(id);<span class="comment">//根据id查出dish表中该id的菜品数据，封装到dish对象（不含菜品口味）</span></span><br><span class="line">    <span class="type">DishDto</span> <span class="variable">dishDto</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DishDto</span>();</span><br><span class="line">    BeanUtils.copyProperties(dish, dishDto);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//现在dishDto中还差菜品口味。从dish_flavor表中，根据dish_id获取name和value，封装到flavors对象中</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询菜品口味信息：select * from dish_flavor where dish_id = ?</span></span><br><span class="line">    LambdaQueryWrapper&lt;DishFlavor&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(DishFlavor::getDishId, id);</span><br><span class="line">    <span class="comment">//调用该表对应的service的方法，查出结果，以List形式封装</span></span><br><span class="line">    List&lt;DishFlavor&gt; list = dishFlavorService.list(queryWrapper);<span class="comment">//查询为列表</span></span><br><span class="line"></span><br><span class="line">    dishDto.setFlavors(list);<span class="comment">//将查出的口味结果，赋给dishDto对象的flavors属性</span></span><br><span class="line">    <span class="keyword">return</span> dishDto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试：</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/16.png" alt="图片"></p>
<p><strong>第4步</strong>：后端需要处理请求<code>/dish</code>，method&#x3D;PUT，接收（修改后的）该id的菜品的价格、售卖状态、图片、菜品口味等数据，将修改后的数据保存到数据库，并返回响应信息。</p>
<p>1、在DishController中添加put方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改菜品信息。处理前端发来的PUT请求/dish（JSON请求）</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> dishDto</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PutMapping</span></span><br><span class="line"><span class="keyword">public</span> R&lt;String&gt; <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> DishDto dishDto)</span>&#123;</span><br><span class="line">    dishService.updateWithFlavor(dishDto);</span><br><span class="line">    <span class="keyword">return</span> R.success(<span class="string">&quot;修改菜品成功&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>说明：</p>
<p>Q：为什么不能复用save()？</p>
<p>A：如果是保存，则填写提交后会新增一条数据。而我们需要根据id，找到表里这条数据，对它进行修改，所以需要重新写一个sercice方法，即updateWithFlavor(dishDto)。</p>
<p>2、在DishService新增updateWithFlavor方法，并在DishServiceImpl中实现</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据菜品的id，用前端用户填写的数据，对dish和dish_flavor表进行修改</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> dishDto</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@Transactional</span> <span class="comment">//涉及多张表，所以使用事务。还需要在主程序加@EnableTransactionManagement，以启用事务</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateWithFlavor</span><span class="params">(DishDto dishDto)</span> &#123;</span><br><span class="line">    <span class="comment">//更新dish表的部分。该id对应的name、category_id、price、code、image、description数据</span></span><br><span class="line">    <span class="built_in">this</span>.updateById(dishDto);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// (1)根据dish_id，清理当前id对应菜品的口味数据--对dish_flavor表的delete操作</span></span><br><span class="line">    <span class="comment">// 想执行的是：delete from dish_flavor where dish_id = ?</span></span><br><span class="line">    <span class="comment">// 注意：不可以用dishFlavorService.removeById();因为removeById用的是dish_flavor的id（主键），此处需要根据&quot;dish_id&quot;字段来查找</span></span><br><span class="line">    LambdaQueryWrapper&lt;DishFlavor&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(DishFlavor::getDishId, dishDto.getId());</span><br><span class="line">    dishFlavorService.remove(queryWrapper);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// (2)添加当前提交的口味数据--对dish_flavor表的insert操作</span></span><br><span class="line">    <span class="comment">//此处用流的方式，将信息封装到item中，给item添加上菜品id，再转成集合，重新赋值给flavors集合(和上面的saveWithFlavor方法一样)</span></span><br><span class="line">    List&lt;DishFlavor&gt; flavors = dishDto.getFlavors();<span class="comment">//此时的flavors集合只有name、value这两项，还要加上dish_id才行</span></span><br><span class="line">    flavors = flavors.stream().map( (item) -&gt;&#123;  <span class="comment">//item：遍历出的每一项，对应一个DishFlavor实体</span></span><br><span class="line">        item.setDishId(dishDto.getId()); <span class="comment">//加工每一个item，把item的属性dishId赋好值</span></span><br><span class="line">        <span class="keyword">return</span> item;</span><br><span class="line">    &#125;).collect(Collectors.toList());</span><br><span class="line">    dishFlavorService.saveBatch(flavors);<span class="comment">//把dishDto中取出的flavors数据保存到dish_service表中</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-5-停售-x2F-启售菜品（支持批量）"><a href="#1-5-停售-x2F-启售菜品（支持批量）" class="headerlink" title="1.5 停售&#x2F;启售菜品（支持批量）"></a>1.5 <strong>停售&#x2F;启售菜品（支持</strong>批量<strong>）</strong></h2><h3 id="1-5-1-需求分析"><a href="#1-5-1-需求分析" class="headerlink" title="1.5.1 需求分析"></a>1.5.1 <strong>需求分析</strong></h3><p>在list.html菜品管理页面，有”售卖状态“这一列。以及“操作”这一列中，有”启售“&#x2F;”停售“的按钮。可以便于管理菜品。</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/17.png" alt="图片"></p>
<p>Dish实体类中有属性status，可以表示商品的售卖状态：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//0：停售 1：起售</span></span><br><span class="line"><span class="keyword">private</span> Integer status;</span><br></pre></td></tr></table></figure>

<h3 id="1-5-2-交互过程分析"><a href="#1-5-2-交互过程分析" class="headerlink" title="1.5.2 交互过程分析"></a>1.5.2 交互过程分析</h3><p>”启售“&#x2F;”停售“按钮的实现（前端）：</p>
<p>1、”售卖状态“这一列的显示：</p>
<p>”售卖状态“这一列中，会将status的值映射为文字，显示在列表中。页面获取到这一行的status，如果为0，”售卖状态“就显示”停售”，如果是1，”售卖状态“显示”启售”。</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/18.png" alt="图片"></p>
<p>2、“操作”这一列”启售“&#x2F;”停售“按钮：</p>
<p>(1) 按钮的显示</p>
<p>当前菜品在数据库中status为1（启售），则“操作”就显示“停售”按钮。当前菜品在数据库中status为0（停售），“操作”就显示“启售”按钮。</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/19.png" alt="图片"></p>
<p>(2) 修改状态数据</p>
<p>点击”启售“&#x2F;”停售“按钮后，执行statusHandle(scope.row)方法，发送请求到服务器，由服务器修改数据库中status的值。具体如下：</p>
<ul>
<li><p>如果是对单个菜品操作：</p>
<p>  点击”启售“&#x2F;”停售“（单个菜品）的按钮后，带着当前这一行的数据，执行statusHandle(scope.row)方法。此时row不是String类型，所以会更改params.status的值。</p>
<p>  <img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/20.png" alt="图片"></p>
<p>  例如，如果数据库中status为0，这行数据的status就是0，则此处执行<code>params.status = row.status ? &#39;0&#39; : &#39;1&#39;</code>之后，params.status为1。</p>
</li>
<li><p>如果是批量操作：</p>
<ul>
<li>如果想批量启售（当前是停售状态，status&#x3D;0），选中多个勾选框，点“批量启售”，会执行statusHandle(‘1’)方法。参数为String型，将参数row的值“1”赋给status。</li>
<li>如果想批量停售（当前是启售状态，status&#x3D;1），选中勾选框，点“批量停售”，会执行statusHandle(‘0’)方法。参数为String型，将参数row的值“0”赋给status。</li>
</ul>
<p>  <img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/21.png" alt="图片"></p>
<p>  <img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/22.png" alt="图片"></p>
</li>
</ul>
<p>这样一来，不管是批量操作还是单一操作，params中封装的status值是更改过的，服务器直接把数据库中的值修改成该status即可。</p>
<p>而对于params中封装的ids，在批量操作时，是逗号隔开的字符串；在单一操作时是当前菜品的id。</p>
<p>在确认修改之后，执行dishStatusByStatus()方法。向<code>/dish/status/$&#123;params.status&#125;</code>发POST请求，并将ids通过url带过去给服务器，需要服务器对数据表的status字段进行修改，并需要服务器返回响应信息。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 起售停售---批量起售停售接口</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">dishStatusByStatus</span> = (<span class="params">params</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> $axios(&#123;</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/dish/status/<span class="subst">$&#123;params.status&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    <span class="attr">params</span>: &#123; <span class="attr">ids</span>: params.<span class="property">id</span> &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后，根据响应，跳转到分页页面。</p>
<h3 id="1-5-3-后端代码实现"><a href="#1-5-3-后端代码实现" class="headerlink" title="1.5.3 后端代码实现"></a>1.5.3 <strong>后端代码实现</strong></h3><p>服务端需要处理传来的POST请求<code>/dish/status/$&#123;params.status&#125;</code>，并对数据表的status字段进行修改，最后返回响应信息。</p>
<p>在DishController新增switchStatus方法，通过数组保存ids，实现单个&#x2F;批量起售停售：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改启售/停售状态，支持批量修改和单独修改</span></span><br><span class="line"><span class="comment"> * 处理请求/dish/status/&#123;status&#125;?ids=xxxxxx,xxxxxx</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> status 前端传来的status已经是修改过的，后端只要保存即可</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ids</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/status/&#123;status&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> R&lt;String&gt; <span class="title function_">switchStatus</span><span class="params">(<span class="meta">@PathVariable</span> Integer status, String[] ids)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(String id : ids)&#123;</span><br><span class="line">        <span class="type">Dish</span> <span class="variable">dish</span> <span class="operator">=</span> dishService.getById(id);<span class="comment">//通过遍历到的当前id，获取dish表中的一条记录，即一个dish对象</span></span><br><span class="line">        dish.setStatus(status); <span class="comment">//将该记录的status改为url路径参数中的status</span></span><br><span class="line">        dishService.updateById(dish);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> R.success(<span class="string">&quot;修改成功&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-6-删除菜品（支持批量）"><a href="#1-6-删除菜品（支持批量）" class="headerlink" title="1.6 删除菜品（支持批量）"></a>1.6 <strong>删除菜品（支持</strong>批量<strong>）</strong></h2><h3 id="1-6-1-需求分析"><a href="#1-6-1-需求分析" class="headerlink" title="1.6.1 需求分析"></a>1.6.1 <strong>需求分析</strong></h3><p>需要实现删除和批量删除。</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/23.png" alt="图片"></p>
<h3 id="1-6-2-交互过程分析"><a href="#1-6-2-交互过程分析" class="headerlink" title="1.6.2 交互过程分析"></a>1.6.2 交互过程分析</h3><p><strong>单删</strong>：对某个菜品，点击“删除”，执行deleteHandle(type, id)方法，type为‘单删’，id为scope.row.id。如下：</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/24.png" alt="图片"></p>
<p><strong>批量删除</strong>：如果是批量删除，选中一些勾选框，再点“批量删除”，执行deleteHandle(type, id)方法，type为‘批量’，id为null。如下：</p>
<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/25.png" alt="图片"></p>
<p>在deleteHandle(type, id)方法中，首先判断是否是「批量删除且0个勾选框被勾选」的情况，需要提示用户信息“请选择删除对象”。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (type === <span class="string">&#x27;批量&#x27;</span> &amp;&amp; id === <span class="literal">null</span>) &#123;<span class="comment">//点了批量删除</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">checkList</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;<span class="comment">//且0个勾选框被勾选</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&#x27;请选择删除对象&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在用户确认删除后（点“确定”），执行deleteDish(ids)方法。该方法判断type的值是“批量”还是“单删”。</p>
<ul>
<li>如果type的值为’批量’，则将选中的勾选框对应的id放到数组中，再将this.checkList数组中的元素（多个id）以逗号分隔，组成一个字符串，作为参数ids传递给deleteDish(ids)函数。deleteDish()中，向<code>/dish</code>发送DELETE请求，在url中携带参数ids（&#x3D;组成的字符串）。</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">handleSelectionChange (val)&#123;</span><br><span class="line">  <span class="keyword">let</span> checkArr = []</span><br><span class="line">  val.<span class="title function_">forEach</span>(<span class="function">(<span class="params">n</span>) =&gt;</span> &#123;</span><br><span class="line">    checkArr.<span class="title function_">push</span>(n.<span class="property">id</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">checkList</span> = checkArr <span class="comment">//将选中的勾选框对应的id放到checkArr数组中，再给checkList数组赋值</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9604-%E8%8F%9C%E5%93%81%E7%AE%A1%E7%90%86/26.png" alt="图片"></p>
<ul>
<li>如果type的值为’单删’，将单个id的值作为参数传递给deleteDish(ids)函数。deleteDish()中，向<code>/dish</code>发送DELETE请求，在url中携带参数ids（&#x3D;单个id）</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">deleteDish</span>(type === <span class="string">&#x27;批量&#x27;</span> ? <span class="variable language_">this</span>.<span class="property">checkList</span>.<span class="title function_">join</span>(<span class="string">&#x27;,&#x27;</span>) : id).<span class="title function_">then</span>()</span><br></pre></td></tr></table></figure>

<p>需要服务器处理请求<code>/dish</code>，删除dish数据表中id对应的菜品，并返回响应。最后，根据响应，跳转到分页页面。</p>
<h3 id="1-6-3-后端代码实现"><a href="#1-6-3-后端代码实现" class="headerlink" title="1.6.3 后端代码实现"></a>1.6.3 <strong>后端代码实现</strong></h3><p>处理请求&#x2F;dish?ids&#x3D;xxx（<strong>单删</strong>）或者&#x2F;dish?ids&#x3D;xxxx,xxxx（<strong>批量删除</strong>），请求方式为DELETE</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除菜品</span></span><br><span class="line"><span class="comment"> * 请求/dish?ids=xxx</span></span><br><span class="line"><span class="comment">	或者/dish?ids=xxxx,xxxx</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ids</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@DeleteMapping</span></span><br><span class="line"><span class="keyword">public</span> R&lt;String&gt; <span class="title function_">delete</span><span class="params">(String[] ids)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (String id : ids)&#123;</span><br><span class="line">        dishService.removeById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> R.success(<span class="string">&quot;删除成功&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
              <a href="/tags/%E9%A1%B9%E7%9B%AE%E7%AC%94%E8%AE%B0/" rel="tag"># 项目笔记</a>
              <a href="/tags/java/" rel="tag"># java</a>
              <a href="/tags/SpringBoot/" rel="tag"># SpringBoot</a>
              <a href="/tags/Spring/" rel="tag"># Spring</a>
              <a href="/tags/Spring-MVC/" rel="tag"># Spring MVC</a>
              <a href="/tags/MyBatis/" rel="tag"># MyBatis</a>
              <a href="/tags/MyBatis-Plus/" rel="tag"># MyBatis Plus</a>
              <a href="/tags/html/" rel="tag"># html</a>
              <a href="/tags/json/" rel="tag"># json</a>
              <a href="/tags/Transaction/" rel="tag"># Transaction</a>
              <a href="/tags/controller/" rel="tag"># controller</a>
              <a href="/tags/Vue/" rel="tag"># Vue</a>
              <a href="/tags/DTO/" rel="tag"># DTO</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9603-%E7%AE%A1%E7%90%86%E5%88%86%E7%B1%BB/" rel="prev" title="瑞吉外卖03-管理分类">
                  <i class="fa fa-chevron-left"></i> 瑞吉外卖03-管理分类
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/05/13/%E7%91%9E%E5%90%89%E5%A4%96%E5%8D%9605-%E5%A5%97%E9%A4%90%E7%AE%A1%E7%90%86/" rel="next" title="瑞吉外卖05-套餐管理">
                  瑞吉外卖05-套餐管理 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Kathy-kx</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  




  





</body>
</html>
